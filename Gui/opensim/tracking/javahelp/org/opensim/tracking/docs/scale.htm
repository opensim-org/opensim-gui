<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="scale_files/filelist.xml">
<title>Steps to prepare a new subject model (xxx is to be replaced with actual
name s26, n187):</title>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
h1
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:24.0pt;
	font-family:"Times New Roman";
	color:black;
	font-weight:bold;}
h2
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:18.0pt;
	font-family:"Times New Roman";
	color:black;
	font-weight:bold;}
h3
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:13.5pt;
	font-family:"Times New Roman";
	color:black;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:262802892;
	mso-list-template-ids:16141134;}
@list l0:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1
	{mso-list-id:619922349;
	mso-list-template-ids:378977044;}
@list l1:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2
	{mso-list-id:1088187813;
	mso-list-template-ids:863793826;}
@list l2:level1
	{mso-level-start-at:5;
	mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.25in;
	text-indent:-.25in;}
@list l2:level2
	{mso-level-tab-stop:1.75in;
	mso-level-number-position:left;
	margin-left:1.75in;
	text-indent:-.25in;}
@list l2:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3
	{mso-list-id:1714310784;
	mso-list-template-ids:-61945872;}
@list l3:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level2
	{mso-level-start-at:0;
	mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	margin-left:2.0in;
	text-indent:-1.25in;
	font-family:Symbol;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Courier New";}
@list l3:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4
	{mso-list-id:1739748656;
	mso-list-template-ids:-320025334;}
@list l4:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l4:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
<meta name=CREATED content="20050907;16504878">
<meta name=CHANGED content="20050908;14220154">
<!--[if gte mso 9]><xml>
 <u1:DocumentProperties>
  <u1:Author>Ayman Habib</u1:Author>
  <u1:LastAuthor>Frank C. Anderson</u1:LastAuthor>
  <u1:Revision>8</u1:Revision>
  <u1:TotalTime>5073</u1:TotalTime>
  <u1:LastPrinted>2005-01-25T20:03:00Z</u1:LastPrinted>
  <u1:Created>2005-02-01T23:18:00Z</u1:Created>
  <u1:LastSaved>2005-05-31T22:07:00Z</u1:LastSaved>
  <u1:Pages>2</u1:Pages>
  <u1:Words>1319</u1:Words>
  <u1:Characters>7519</u1:Characters>
  <u1:Company>Stanford University</u1:Company>
  <u1:Lines>62</u1:Lines>
  <u1:Paragraphs>15</u1:Paragraphs>
  <u1:CharactersWithSpaces>9233</u1:CharactersWithSpaces>
  <u1:Version>9.6926</u1:Version>
 </u1:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <u2:WordDocument>
  <u2:Zoom>150</u2:Zoom>
  <u2:PunctuationKerning/>
  <u2:Compatibility>
   <u2:BreakWrappedTables/>
   <u2:SnapToGridInCell/>
   <u2:WrapTextWithPunct/>
   <u2:UseAsianBreakRules/>
   <u2:DontGrowAutofit/>
  </u2:Compatibility>
  <u2:BrowserLevel>MicrosoftInternetExplorer4</u2:BrowserLevel>
  <u2:DontDisplayPageBoundaries/>
  <u2:SpellingState>Clean</u2:SpellingState>
  <u2:GrammarState>Clean</u2:GrammarState>
  <u2:ValidateAgainstSchemas/>
  <u2:SaveIfXMLInvalid>false</u2:SaveIfXMLInvalid>
  <u2:IgnoreMixedContent>false</u2:IgnoreMixedContent>
  <u2:AlwaysShowPlaceholderText>false</u2:AlwaysShowPlaceholderText>
 </u2:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <u3:LatentStyles DefLockedState="false" LatentStyleCount="156">  </u3:LatentStyles>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="3074"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h1>Subject specific simulation workflow - <br>
Scaling</h1>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>&nbsp;</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>This
document is intended as a documentation of the steps that need to be taken by
researchers trying to create and analyze subject specific simulations. The
document is a work in progress and should be amended whenever new info that
helps customize/improve the workflow becomes available. The changes from
previous version of the workflow are marked in <span style='color:green'>green</span>.</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>&nbsp;</p>

<h3><a name="_Workflow_outline"></a>Workflow outline</h3>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l3 level1 lfo1;
tab-stops:list .5in'><![if !supportLists]><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>Subject
specific motion capture data is obtained from one of the collaborating
hospitals/centers and preprocessed to match the assumptions in the workflow,
this preprocessing is not yet covered in this document. </p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l3 level1 lfo1;
tab-stops:list .5in'><![if !supportLists]><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>Motion
capture data is used to scale a standard nominal model (that has been tested
and validated) to match the size of the subject. We’ll call it subject-model. (<a
href="#runDarrylsScripts">step</a>) </p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l3 level1 lfo1;
tab-stops:list .5in'><![if !supportLists]><span style='mso-list:Ignore'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>Inverse
kinematics is used to calculate joint kinematics that best reproduce
experimental data using the subject-model. This is done by minimizing the
weighted sum of errors in a set of markers for each frame of the motion. (<a
href="#runDarrylsScripts">step</a>) </p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l3 level1 lfo1;
tab-stops:list .5in'><![if !supportLists]><span style='mso-list:Ignore'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>The
motion that results from inverse kinematics will generally be not dynamically
consistent with measured ground reaction forces, REA (Residual Elimination
Algorithm) is performed on the motion resulting from inverse kinematics to
adjust few generalized coordinates (back angles and pelvis translations) to
make the motion dynamically consistent with measured ground reaction forces. (<a
href="#runDarrylsScripts">step</a>) </p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l3 level1 lfo1;
tab-stops:list .5in'><![if !supportLists]><span style='mso-list:Ignore'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>With
dynamically consistent motion and ground reaction forces, computed muscle
control (CMC) is used to compute muscle excitations to drive the model through
the motion. The output of CMC is a SIMM motion file that contains a set of
muscle excitations or an xml file containing muscle excitations for use by the
forward simulation step. (<a href="#runDarrylsScripts">step</a>) </p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l3 level1 lfo1;
tab-stops:list .5in'><![if !supportLists]><span style='mso-list:Ignore'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>An
open loop forward simulation is performed using the subject-model, muscle
excitations from previous step. Analyses can be attached to the forward
simulation to record quantities of interest. (<a href="#runAndAnalyze">step</a>)
</p>

<h3>Prerequisites</h3>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l4 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>You
have to have the RDI platform installed which includes: </p>

<p style='margin-left:1.0in;text-indent:-.25in;mso-list:l4 level2 lfo2;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New";mso-fareast-font-family:
"Courier New"'><span style='mso-list:Ignore'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span class=SpellE>Cygwin</span> (modules: <span
class=SpellE>perl</span> ) </p>

<p style='margin-left:1.0in;text-indent:-.25in;mso-list:l4 level2 lfo2;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New";mso-fareast-font-family:
"Courier New"'><span style='mso-list:Ignore'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span class=SpellE><span style='color:green'>Cmake</span></span><span
style='color:green'> (from <a href="http://www.cmake.org/"><span
style='color:green'>www.cmake.org</span></a> version 2.0.6 or later) (Optional)</span>.</p>

<p style='margin-left:1.0in;text-indent:-.25in;mso-list:l4 level2 lfo2;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New";mso-fareast-font-family:
"Courier New"'><span style='mso-list:Ignore'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Microsoft Developer Studio (version 7.1 &amp;
version 6.0 are explicitly supported with project files others can use CMake). </p>

<p style='margin-left:1.0in;text-indent:-.25in;mso-list:l4 level2 lfo2;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New";mso-fareast-font-family:
"Courier New";color:green'><span style='mso-list:Ignore'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='color:green'>NMBL installation
(directories Lib, Include, Template)<o:p></o:p></span></p>

<p style='margin-left:1.0in;text-indent:-.25in;mso-list:l4 level2 lfo2;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New";mso-fareast-font-family:
"Courier New"'><span style='mso-list:Ignore'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='color:green'>RDI LICENSE FILE in
order to run the CMC executable</span>.</p>

<p style='margin-left:1.0in;text-indent:-.25in;mso-list:l4 level2 lfo2;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New";mso-fareast-font-family:
"Courier New"'><span style='mso-list:Ignore'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span class=SpellE>Nmbl</span> source code
repository (Optional) </p>

<p style='margin-left:1.0in;text-indent:-.25in;mso-list:l4 level2 lfo2;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New";mso-fareast-font-family:
"Courier New"'><span style='mso-list:Ignore'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Environment variables are set properly per the
RDI installation, in particular. </p>

<p style='margin-left:1.5in;text-indent:-.25in;mso-list:l4 level3 lfo2;
tab-stops:list 1.5in'><![if !supportLists]><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>RDI_INSTALL=Root
directory for RDI install on your machine, </p>

<p style='margin-left:1.5in;text-indent:-.25in;mso-list:l4 level3 lfo2;
tab-stops:list 1.5in'><![if !supportLists]><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>RDI_ARCH=VC71
or VC6 (depending on your <span class=SpellE>DevStudio</span> version). </p>

<p style='margin-left:1.5in;text-indent:-.25in;mso-list:l4 level3 lfo2;
tab-stops:list 1.5in'><![if !supportLists]><span style='color:green'><span
style='mso-list:Ignore'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='color:green'>NMBL_INSTALL=Root
directory for NMBL installation/libraries. If using pre-built libraries set
NMBL_INSTALL to the top download directory.<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l4 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>Build
the following libraries, or get them from the distribution (If you get ready
made libraries make sure they correspond to your <span class=SpellE>DevStudio</span>
version). Place the libraries under NMBL_INSTALL /Lib/VC71/ debug or release
NMBL_INSTALL /Lib/VC6/) for version 7.1 (6).&nbsp;</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='mso-cellspacing:0in;mso-padding-alt:0in 0in 0in 0in'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=156 valign=top style='width:117.0pt;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:solid black 1.0pt;padding:
  1.0pt 1.0pt 1.0pt 1.0pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  1.0pt 1.0pt 1.0pt 1.0pt'><i><span style='font-size:9.0pt'>Library name</span></i></p>
  </div>
  </td>
  <td width=192 valign=top style='width:2.0in;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:solid black 1.0pt;padding:
  1.0pt 1.0pt 1.0pt 1.0pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  1.0pt 1.0pt 1.0pt 1.0pt'><span class=SpellE><i><span style='font-size:9.0pt'>DevStudio</span></i></span><i><span
  style='font-size:9.0pt'> Project</span></i></p>
  </div>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=156 valign=top style='width:117.0pt;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:solid black 1.0pt;padding:
  1.0pt 1.0pt 1.0pt 1.0pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  1.0pt 1.0pt 1.0pt 1.0pt'><span class=SpellE><span style='font-size:9.0pt'>rdTools.lib</span></span></p>
  </div>
  </td>
  <td width=192 valign=top style='width:2.0in;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:none;border-bottom:solid black 1.0pt;
  padding:0in 0in 1.0pt 0in'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-bottom-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  0in 0in 1.0pt 0in'><span class=SpellE><span style='font-size:9.0pt'>rdTools</span></span></p>
  </div>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=156 valign=top style='width:117.0pt;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:solid black 1.0pt;padding:
  1.0pt 1.0pt 1.0pt 1.0pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  1.0pt 1.0pt 1.0pt 1.0pt'><span class=SpellE><span style='font-size:9.0pt'>rdSimulation.lib</span></span></p>
  </div>
  </td>
  <td width=192 valign=top style='width:2.0in;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:none;border-bottom:solid black 1.0pt;
  padding:0in 0in 1.0pt 0in'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-bottom-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  0in 0in 1.0pt 0in'><span class=SpellE><span style='font-size:9.0pt'>rdSimulation</span></span></p>
  </div>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=156 valign=top style='width:117.0pt;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:solid black 1.0pt;padding:
  1.0pt 1.0pt 1.0pt 1.0pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  1.0pt 1.0pt 1.0pt 1.0pt'><span class=SpellE><span style='font-size:9.0pt'>rdSDFast.lib</span></span></p>
  </div>
  </td>
  <td width=192 valign=top style='width:2.0in;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:none;border-bottom:solid black 1.0pt;
  padding:0in 0in 1.0pt 0in'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-bottom-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  0in 0in 1.0pt 0in'><span class=SpellE><span style='font-size:9.0pt'>rdSDFast</span></span></p>
  </div>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=156 valign=top style='width:117.0pt;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:solid black 1.0pt;padding:
  1.0pt 1.0pt 1.0pt 1.0pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  1.0pt 1.0pt 1.0pt 1.0pt'><span style='font-size:9.0pt'>suPipeline40.lib</span></p>
  </div>
  </td>
  <td width=192 valign=top style='width:2.0in;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:none;border-bottom:solid black 1.0pt;
  padding:0in 0in 1.0pt 0in'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-bottom-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  0in 0in 1.0pt 0in'><span style='font-size:9.0pt'>suPipeline40</span></p>
  </div>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=156 valign=top style='width:117.0pt;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:solid black 1.0pt;padding:
  1.0pt 1.0pt 1.0pt 1.0pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  1.0pt 1.0pt 1.0pt 1.0pt'><span style='font-size:9.0pt'>suPipeline40Workflow.lib</span></p>
  </div>
  </td>
  <td width=192 valign=top style='width:2.0in;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:none;border-bottom:solid black 1.0pt;
  padding:0in 0in 1.0pt 0in'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-bottom-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  0in 0in 1.0pt 0in'><span style='font-size:9.0pt'>suPipeline40Workflow</span></p>
  </div>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=156 valign=top style='width:117.0pt;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:solid black 1.0pt;padding:
  1.0pt 1.0pt 1.0pt 1.0pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  1.0pt 1.0pt 1.0pt 1.0pt'><span class=SpellE><span style='font-size:9.0pt'>suAnalyses.lib</span></span></p>
  </div>
  </td>
  <td width=192 valign=top style='width:2.0in;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:none;border-bottom:solid black 1.0pt;
  padding:0in 0in 1.0pt 0in'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-bottom-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  0in 0in 1.0pt 0in'><span class=SpellE><span style='font-size:9.0pt'>suAnalyses</span></span></p>
  </div>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7;mso-yfti-lastrow:yes'>
  <td width=156 valign=top style='width:117.0pt;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:solid black 1.0pt;padding:
  1.0pt 1.0pt 1.0pt 1.0pt'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  1.0pt 1.0pt 1.0pt 1.0pt'><span class=SpellE><span style='font-size:9.0pt'>Acpp.lib</span></span></p>
  </div>
  </td>
  <td width=192 valign=top style='width:2.0in;padding:0in 0in 0in 0in'>
  <div style='mso-element:para-border-div;border:none;border-bottom:solid black 1.0pt;
  padding:0in 0in 1.0pt 0in'>
  <p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
  border:none;mso-border-bottom-alt:solid black 1.0pt;padding:0in;mso-padding-alt:
  0in 0in 1.0pt 0in'><span style='font-size:9.0pt'>$NMBL_INSTALL/Lib/$Arch</span></p>
  </div>
  </td>
 </tr>
</table>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>&nbsp;<span
class=SpellE><span style='color:green'>RdCMC.lib</span></span><span
style='color:green'>, <span class=SpellE>rdSecurity.lib</span> <span
class=GramE>are</span> the RDI specific libraries used to run CMC.<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><span
style='font-size:13.0pt;font-family:Arial'>Directory structure &amp; file
descriptions</span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>Users
can create arbitrary directories to contain subject specific data files and executables.
No assumptions are made about where this directory is located. Darryl’s code
generates a directory for every subject that contains data files under the name
data/xxx where xxx is the name of the subject. We’ll call this directory <span
class=SpellE><i>SubjectDirectory</i></span>. The subject directory will contain
files generated by the preprocessing steps of Darryl as well as the files
created by SIMM and SDFast. Only a few of these files are relevant to running
CMC and/or creating and running forward simulations. A brief description of
these relevant files follows:</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.0in;text-indent:-.25in'><span class=GramE><span style='font-family:
"Courier New"'>o</span></span><span style='font-family:"Courier New"'>&nbsp;</span>Source
code files:</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.25in;text-indent:-.25in'>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>suxxx.cpp</span></span>, <span
class=SpellE>suxxx.h</span> (Created by the script in <a
href="#runMakeprojectScript">step</a>.&nbsp; File usage: wrapper to make the
model into a c++ class to be used for simulation in RDI platform).</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.25in;text-indent:-.25in'>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>sdufuncs_darryl.c</span></span> (Created
by the script in <a href="#runMakeprojectScript">step</a>. File usage:
collection of functions used to initialize <span class=SpellE>sdfast</span> and
functions to be called by <span class=SpellE>sdfast</span> for calculation of
derivatives, constraints, <span class=GramE>forces,..</span> It includes
changes made by Darryl. This file is not subject specific but left at this
level for potential modification).</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.25in;text-indent:-.25in'>3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>sdfor.c</span></span>, (Created by SIMM in
<a href="#generateDyn">step</a>).</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.25in;text-indent:-.25in'>4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>xxx_dyn.c</span></span>, <span
class=SpellE>xxx_sar.c</span> (Created in <a href="#runSDFast">step</a> by <span
class=SpellE>sdfast</span> based on the system description file <span
class=SpellE>model.sd</span> generated by SIMM in <a href="#generateDyn">step</a>.
File usage: along with <span class=SpellE>sdfor.c</span> these three files
describe the dynamic behavior of the model and implement the equations of
motion specific to the subject).</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.25in;text-indent:-.25in;mso-list:l2 level1 lfo3;tab-stops:list 1.25in'><![if !supportLists]><span
style='mso-list:Ignore'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Main driver programs for different tasks:</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.75in;text-indent:-.25in;mso-list:l2 level2 lfo3;tab-stops:list 1.75in'><![if !supportLists]><span
style='color:green'><span style='mso-list:Ignore'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span class=SpellE><span style='color:green'>suxxx_CMC.cpp</span></span><span
style='color:green'> (Created by the script in <a href="#runMakeprojectScript"><span
style='color:green'>step</span></a>. File usage: driver for CMC that solves the
tracking problem and generates muscle excitations/controls).<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.75in;text-indent:-.25in;mso-list:l2 level2 lfo3;tab-stops:list 1.75in'><![if !supportLists]><span
style='mso-list:Ignore'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span class=SpellE>suxxx_Forward.cpp</span> (Created by
the script in <a href="#runMakeprojectScript">step</a>. File usage: driver for
the forward simulation that instantiates the model, controls, analyses and runs
the simulation).</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.75in;text-indent:-.25in;mso-list:l2 level2 lfo3;tab-stops:list 1.75in'><![if !supportLists]><span
style='color:green'><span style='mso-list:Ignore'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span class=SpellE><span style='color:green'>suxxx_Perturb.cpp</span></span><span
style='color:green'> (Created by the script in <a href="#runMakeprojectScript"><span
style='color:green'>step</span></a>. File usage: driver for the forward
simulation with perturbation).<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.0in;text-indent:-.25in'><span class=GramE><span style='font-family:
"Courier New"'>o</span></span><span style='font-family:"Courier New"'>&nbsp;</span>Data
files:</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.25in;text-indent:-.25in'>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>xxx.jnt</span></span>, <span class=SpellE>xxx.msl</span>
(SIMM joint and muscle files created in <a href="#runDarrylsScripts">step</a>).</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.25in;text-indent:-.25in'>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>xxxcmc.mot</span></span> (motion file
output of <span class=SpellE>cmc</span>, including muscle excitations computed
in <a href="#runDarrylsScripts">step</a>).</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.25in;text-indent:-.25in'>3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>xxxcmc.ctr</span></span> (muscle
excitations extracted from <span class=SpellE>xxxcmc.mot</span> in xml format.
This file is created in <a href="#extractControls">step</a>).</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.25in;text-indent:-.25in'>4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>params.txt</span> (parameters used to initialize the model
including muscle file name, and motion file to initialize positions, velocities
and accelerations. <span class=GramE>Created by SIMM in <a href="#generateDyn">step</a>).</span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.25in;text-indent:-.25in'><span style='color:green'>5.</span><span
style='mso-tab-count:2'>         </span><span class=SpellE><span class=GramE><span
style='color:green'>xxx.trk</span></span></span><span style='color:green'>
(files that contains the parameters of the <span class=SpellE>cmc</span>
algorithm, weights, what to track,<span style='mso-spacerun:yes'>  </span>…).<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.25in;text-indent:-.25in'><span style='color:green'>6. <span
style='mso-tab-count:2'>        </span><span class=SpellE><span class=GramE>xxx_constraints.ctr</span></span>
(a file containing example excitation constraints, subject specific and will
generally need user editing).<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.0in;text-indent:-.25in'><span class=GramE><span style='font-family:
"Courier New"'>o</span></span><span style='font-family:"Courier New"'>&nbsp;</span>Support
files to build the executables needed to execute all the steps: (*.<span
class=SpellE>sln</span> *.<span class=SpellE>vcproj</span>, *.<span
class=SpellE>dsp</span>, *.<span class=SpellE>dsw</span>) <span
style='color:green'>and CmakeLists.txt which can be used by <span class=SpellE>Cmake</span>
to generate the proper dev studio files and can be used in non windows
environments as well as other <span class=SpellE>DevStudio</span> versions</span>.</p>

<h2>Steps: </h2>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>In
the following steps, “xxx” should be replaced with an actual subject name (e.g.
s26, n187). Names are case sensitive, use small letters when prompted for model
name. Model names can include underscores and have no length restrictions so
you can use n123_05 for version 5 of the model for subject n123, you just need
to make sure that the muscle, joint and control files all observe the same
naming. </p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>&nbsp;</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'>Item
1 in the <a href="#_Workflow_outline">workflow outline</a> (preprocessing) is
not accounted for in these steps. Items 2-5 of the outline are done using
Darryl’s provided scripts. Customization and tuning of these scripts is still
underway. The steps below target item 6 of the workflow outline (running and
analyzing a forward simulation of the subject model). To build and run the
executable that simulates the subject model we need to:</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:2.0in;text-indent:-1.25in;mso-list:l3 level2 lfo1;tab-stops:list 2.0in'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Setup input files for simulation (Steps 1, 3
below)</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:2.0in;text-indent:-1.25in;mso-list:l3 level2 lfo1;tab-stops:list 2.0in'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Generate equations of motion for the subject
from SIMM model. (Steps 4-6)</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:2.0in;text-indent:-1.25in;mso-list:l3 level2 lfo1;tab-stops:list 2.0in'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Wrap equations of motion into C++ class.
(Automated in Step 2)</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:2.0in;text-indent:-1.25in;mso-list:l3 level2 lfo1;tab-stops:list 2.0in'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Properly initialize the model (Step 6)</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:2.0in;text-indent:-1.25in;mso-list:l3 level2 lfo1;tab-stops:list 2.0in'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;color:green'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='color:green'>Build and run CMC
tracking solution. (steps 7-8)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:2.0in;text-indent:-1.25in;mso-list:l3 level2 lfo1;tab-stops:list 2.0in'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Write main program to instantiate the model, launch
simulation and add analyses to it. (Automated in Step 2)</p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:2.0in;text-indent:-1.25in;mso-list:l3 level2 lfo1;tab-stops:list 2.0in'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Build and run the simulation (Steps 9-10).<o:p></o:p></p>

<h3 style='font-weight:medium'><span style='font-size:12.0pt'>The rest of the
steps move files around to have them in the proper directory for simulation.</span></h3>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo4;
tab-stops:list .5in'><a name=runDarrylsScripts></a><![if !supportLists]><span
style='mso-list:Ignore'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Run Darryl’s scripts to create subject directory (xxx)
and create the files <span class=SpellE>xxx.jnt</span>, <span class=SpellE>xxx.msl</span>,
<span class=SpellE>xxxrea.mot</span> in it. </p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo4;
tab-stops:list .5in'><a name=runMakeprojectScript></a><![if !supportLists]><span
style='mso-list:Ignore'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Change to subject directory (xxx) and run the script
makeProject.pl from repository using command: <span class=SpellE><b><i>perl</i></b></span><b><i>
“$NMBL_INSTALL”/Bin/makeProject.pl</i></b>. This adds the following source
files to the subject directory (<span class=SpellE>suxxx.cpp</span>, <span
class=SpellE>suxxx.h</span>, <span class=SpellE>suxxx_Forward.cpp</span>, <span
class=SpellE><span style='color:green'>suxxx_Perturb.cpp</span></span><span
style='color:green'> <span class=SpellE>suxxx_CMC.cpp</span></span> <span
class=SpellE>sdufuncs_darryl.c</span>). It also creates Microsoft project files
to build the CMC executable, forward simulation executable, and perturbation
executable (<span class=SpellE>suxxx</span>*.<span class=SpellE>sln</span>
&amp; <span class=SpellE>suxxx</span>*.<span class=SpellE>vcproj</span>) for version
7.1 (<span class=SpellE>suxxx.dsw</span>/ <span class=SpellE>suxxx.dsp</span>
for version 6) a CMakeLists.txt file is also generated which can be used to
generate the project files for any <span class=SpellE>devStudio</span> version
or generate <span class=SpellE><span class=GramE>unix</span></span> style <span
class=SpellE>makefiles</span>. </p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo4;
tab-stops:list .5in'><a name=generateDyn></a><![if !supportLists]><span
style='mso-list:Ignore'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Start SIMM4.0 and open the files <span class=SpellE>xxx.jnt</span>
&amp; <span class=SpellE>xxx.msl</span> from step 1. (Some bone files may be
missing though this does not affect results). </p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style='mso-list:Ignore'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>Select
File/<span class=SpellE>SaveDynamics</span> and check all checkboxes, save to
the default xxx directory. This generates a lot of files and directories needed
to run the simulation in SIMM but these are not relevant for the workflow
except for (params.txt, <span class=SpellE>dynsim/src/model.sd</span> and <span
class=SpellE>dynsim/src/sdfor.c</span>) </p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo4;
tab-stops:list .5in'><a name=runSDFast></a><![if !supportLists]><span
style='mso-list:Ignore'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Run <span class=SpellE>sdfast</span> (on Hill) on the
input file <span class=SpellE>dynsim/src/model.sd</span> to generate files <span
class=SpellE>xxx_dyn.c</span>, <span class=SpellE>xxx_sar.c</span> and copy
them back to the subject directory (xxx). </p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo4;
tab-stops:list .5in'><a name=buildsimulator1></a><![if !supportLists]><span
style='mso-list:Ignore'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Add the line “<span class=SpellE>kinetics_file</span> <span
class=SpellE>xxxrea.mot</span>” to the file params.txt created by SIMM in step
4 (at line 16 of the file)</p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo4;
tab-stops:list .5in'><a name=buildsimulator></a><![if !supportLists]><span
style='color:green'><span style='mso-list:Ignore'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='color:green'>Build the CMC
executable using <span class=SpellE><b><i>devenv</i></b></span><b><i> <span
class=SpellE>suxxx.sln</span> /build Debug /project <span class=SpellE>suxxx_CMC.vcproj</span></i>
</b>in the subject directory, this creates an executable suxxx_CMC.exe. (<span
class=GramE>for</span> vc6.0 use ?? instead). Alternatively bring up <span
class=SpellE>DevStudio</span>, open project <span class=SpellE>suxxx.sln</span>
and build project <span class=SpellE>suxxx_CMC</span>.<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo4;
tab-stops:list .5in'><a name=runAndAnalyze1></a><![if !supportLists]><span
style='color:green'><span style='mso-list:Ignore'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='color:green'>Run the executable
generated in previous step <b style='mso-bidi-font-weight:normal'>in the
subject directory</b>, it should generate a new file <span class=SpellE>suxxx.ctr</span>
that contains muscle excitations. With no parameters, the executable uses <span
class=GramE>a robust but slower optimization criteria</span> to solve the
static optimization problem, passing a parameter (f or F) to the executable
causes it to use a faster, more accurate but less robust optimization criteria.
Note that you must add the path to the libraries you want to use (e.g. <b><i>$NMBL_INSTALL/Lib/VC71/debug)
</i></b><span style='mso-bidi-font-weight:bold;mso-bidi-font-style:italic'>to
the front of your path so that the libraries can be found by the executable.
Also make sure that the subject directory s your current directory when running
the executable since the file params.txt lives in this directory.</span><o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style='mso-list:Ignore'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>Build
the forward simulation (or perturbation) executable using <span class=SpellE><b><i>devenv</i></b></span><b><i>
<span class=SpellE>suxxx.sln</span> /build Debug /project <span class=SpellE>suxxx_Forward.vcproj</span></i>
(<span class=SpellE>suxxx_Perturb.vcproj</span>) </b>in the subject directory,
this creates an executable suxxx_Forward.exe. (suxxx_Perturb.exe). </p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo4;
tab-stops:list .5in'><a name=runAndAnalyze></a><![if !supportLists]><span
style='mso-list:Ignore'>10.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><![endif]>Run
the executable generated in previous step in the subject directory. Analysis
results are stored under the Results or <span class=SpellE>ResultsPerturbed</span>
subdirectory. You can view the motion in SIMM4 by changing the extension of the
file Results/<span class=SpellE>xxx_Kinematics_q.sto</span> to .mot and open it
in SIMM. </p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto'><b
style='mso-bidi-font-weight:normal'>&nbsp;Summary of changes:<o:p></o:p></b></p>

<ol start=1 type=1>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l1 level1 lfo5;tab-stops:list .5in'>A new executable to run CMC
     and the infra structure needed to build it was added.</li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l1 level1 lfo5;tab-stops:list .5in'>Added the ability to use <span
     class=SpellE>Cmake</span> rather than specific <span class=SpellE><span
     class=GramE>microsoft</span></span> project files.</li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l1 level1 lfo5;tab-stops:list .5in'>The step to convert storage
     to controls was removed since the <span class=SpellE>cmc</span> output is
     in the same format to be used by the forward simulation program.</li>
</ol>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:.25in'><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
